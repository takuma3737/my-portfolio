# Requirements Document

## Introduction

記事に対する読者のエンゲージメントを向上させるため、コメント機能といいね機能を追加する。これにより読者との交流を促進し、記事の評価やフィードバックを収集できるようにする。転職活動において、読者からの反応や評価を示すことで技術力と発信力をアピールする材料とする。

## Requirements

### Requirement 1

**User Story:** 読者として、記事に対していいねを押したいので、記事が役に立ったことを簡単に表現できる

#### Acceptance Criteria

1. WHEN 読者が記事ページを開く THEN システムは記事下部にいいねボタンと現在のいいね数を表示する SHALL
2. WHEN 読者が初回いいねボタンを押す THEN システムは DB のいいね数を 1 増加させ、ローカルストレージに「いいね済み」を記録し、ボタンを「いいね済み」状態に変更する SHALL
3. WHEN いいね済みの読者が再度いいねボタンを押す THEN システムは DB のいいね数を 1 減少させ、ローカルストレージから「いいね済み」を削除し、ボタンを「未いいね」状態に戻す SHALL
4. WHEN ページを再読み込みする THEN システムはローカルストレージを確認して読者のいいね状態を復元し、DB から最新のいいね数を取得して表示する SHALL

### Requirement 2

**User Story:** 読者として、記事に対してコメントを投稿したいので、記事の内容について質問や感想を共有できる

#### Acceptance Criteria

1. WHEN 読者が記事ページを開く THEN システムは記事下部にコメント投稿フォーム（名前入力欄、コメント入力欄、投稿ボタン）と既存コメント一覧を表示する SHALL
2. WHEN 読者が名前入力欄に名前を入力してコメント入力欄にコメントを入力して投稿ボタンを押す THEN システムはコメントを DB に保存してコメント一覧に追加表示する SHALL
3. WHEN 読者が名前入力欄を空のままでコメント入力欄にコメントを入力して投稿ボタンを押す THEN システムは投稿者名を「匿名」としてコメントを DB に保存して表示する SHALL
4. WHEN コメントが投稿される THEN システムは投稿日時を記録してコメントと一緒に表示する SHALL
5. IF コメント入力欄が空の場合 THEN システムは投稿を拒否して「コメントを入力してください」エラーメッセージを表示する SHALL

### Requirement 3

**User Story:** サイト管理者として、不適切なコメントを管理したいので、サイトの品質を維持できる

#### Acceptance Criteria

1. WHEN 管理者がコメント管理画面にアクセスする THEN システムは全てのコメント一覧を表示する SHALL
2. WHEN 管理者が不適切なコメントを選択して削除ボタンを押す THEN システムはコメントを削除して表示から除外する SHALL
3. WHEN コメントが削除される THEN システムは削除ログを記録する SHALL

### Requirement 4

**User Story:** 読者として、スパムや不適切なコメントに悩まされたくないので、安全で快適な環境で記事を読める

#### Acceptance Criteria

1. WHEN コメントが投稿される THEN システムは基本的なスパム検証を実行する SHALL
2. IF コメントに不適切なキーワードが含まれる THEN システムは投稿を拒否してエラーメッセージを表示する SHALL
3. WHEN 短時間に同じ IP アドレスから複数のコメントが投稿される THEN システムは投稿を制限する SHALL

### Requirement 5

**User Story:** 読者として、コメント一覧で投稿者と投稿日時を確認したいので、コメントの信頼性を判断できる

#### Acceptance Criteria

1. WHEN コメント一覧が表示される THEN システムは各コメントに投稿者名と投稿日時を表示する SHALL
2. WHEN 投稿者名が「匿名」の場合 THEN システムは「匿名」と表示する SHALL
3. WHEN 投稿日時が表示される THEN システムは「YYYY 年 MM 月 DD 日 HH:MM」形式で表示する SHALL

### Requirement 6

**User Story:** 読者として、自分が投稿したコメントを編集したいので、誤字や内容の修正ができる

#### Acceptance Criteria

1. WHEN 読者が自分のコメントを表示している THEN システムはそのコメントに「編集」ボタンを表示する SHALL
2. WHEN 読者が「編集」ボタンを押す THEN システムはコメント内容を編集可能なフォームに変更する SHALL
3. WHEN 読者が編集内容を保存する THEN システムはコメントを更新して DB に保存し、編集日時を記録する SHALL
4. WHEN 読者が編集をキャンセルする THEN システムは元のコメント表示に戻る SHALL
5. IF 編集後のコメント内容が空の場合 THEN システムは保存を拒否して「コメントを入力してください」エラーメッセージを表示する SHALL

### Requirement 7

**User Story:** 読者として、自分が投稿したコメントを削除したいので、不要になったコメントを取り除ける

#### Acceptance Criteria

1. WHEN 読者が自分のコメントを表示している THEN システムはそのコメントに「削除」ボタンを表示する SHALL
2. WHEN 読者が「削除」ボタンを押す THEN システムは削除確認ダイアログを表示する SHALL
3. WHEN 読者が削除を確認する THEN システムはコメントを削除してコメント一覧から除外する SHALL
4. WHEN 読者が削除をキャンセルする THEN システムは削除処理を中止してコメントを保持する SHALL
5. WHEN コメントが削除される THEN システムは削除ログを記録する SHALL

### Requirement 8

**User Story:** 読者として、自分のコメントと他人のコメントを区別したいので、適切な操作ボタンが表示される

#### Acceptance Criteria

1. WHEN 読者がコメント一覧を表示する THEN システムは読者が投稿したコメントのみに「編集」「削除」ボタンを表示する SHALL
2. WHEN 読者が他人のコメントを表示する THEN システムは「編集」「削除」ボタンを表示しない SHALL
3. WHEN 読者の識別ができない場合 THEN システムはすべてのコメントで「編集」「削除」ボタンを表示しない SHALL
